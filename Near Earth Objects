---
title: "DATS 6101 Project 1"
author: "Tyler Wallett, Anushka Vuppala and David Li"
# date: "today"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: hide
    number_sections: false
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
---
```{r init, include=F}
library(ezids)
```
<span style="color: Blue;"> Our research topic aims to perform explorartory data analysis on the Nearest Earth Objects (NEO) dataset recorded by NASA. This particular dataset includes thousands of labeled observations, over the last 22 years, across multiple attributes that each aim to describe a specific object. Borrowing from the humor of the recent film *Don’t Look Up* by Adam Mckay and NASA’s success in the Double Asteroid Redirection Test (DART) mission, we thought that further describing and exploring this dataset would be opportune.</span> 

```{r setup, include=FALSE}
# some of common options (and the defaults) are: 
# include=T, eval=T, echo=T, results='hide'/'asis'/'markup',..., collapse=F, warning=T, message=T, error=T, cache=T, fig.width=6, fig.height=4, fig.dim=c(6,4) #inches, fig.align='left'/'center','right', 
# knitr::opts_chunk$set(warning = F, results = "markup", message = F)
knitr::opts_chunk$set(warning = F, results = "hide", message = F)
# knitr::opts_chunk$set(include = F)
# knitr::opts_chunk$set(echo = TRUE)
options(scientific=T, digits = 3) 
# options(scipen=9, digits = 3) 
# use scipen=999 to prevent scientific notation at all times
```

```{r import_data}
getwd()
neo <- data.frame(read.csv("neo.csv", header = TRUE))
str(neo)
head(neo)
```




```{r, results='markup'}
#Tyler 
# 6. Initial Correlation
loadPkg('corrplot')
neo$hazardous = ifelse(neo$hazardous == 'True',1,0)
neo$hazardous = as.numeric(neo$hazardous)
str(neo)
x = cor(neo[c(5,6,9,10)], method = 'spearman')
y = cor(neo[c(5,6,9,10)], method = 'pearson')
corrplot.mixed(x)
corrplot.mixed(y)
```


```{r, results='markup'}
#Tyler 
#1. Summary of the data set (str(), summary(), subset(), edited variable to `millions of kilometers`)
#2. Descriptive statistics (summary- mean(), median()-, range(), sd())
#3. Graphical interpretations of the data
#4. [When Applicable] Measures of variance
#5. [When Applicable] Normality tests
#6. [When Applicable] Initial correlation - Chi-Squared tests - ANOVA analysis - T-test/Intervals
```

```{r, results='markup'}
#Tyler 
#2. Descriptive statistics:

neo_tyler = neo[c(2, 6, 10)] #getting the columns name, miss_distance and hazardous
neo_tyler$hazardous = factor(neo_tyler$hazardous)
str(neo_tyler) #showing the data types

neo_tyler$miss_distance = neo_tyler$miss_distance/1.496e+8 #Expressing unit in au (astronomical units)

summary(neo_tyler$miss_distance ) #summarizing only numeric variable in au

neo_tyler$miss_distance = (neo_tyler$miss_distance * 1.496e+8)/1000000

neo_h_tyler = subset(neo_tyler, neo_tyler$hazardous == 1) #Sub-setting the data into hazardous 
neo_nh_tyler = subset(neo_tyler, neo_tyler$hazardous == 0) #Sub-setting the data into non-hazardous

summary(neo_h_tyler$miss_distance) #Summary of hazardous miss_distance
summary(neo_nh_tyler$miss_distance) #Summary of non-hazardous miss_distance
```

```{r, results='markup'}
#Tyler 
#4. [When Applicable] Measures of variance / sd

#For neo_h_tyler as a whole:
sd(neo_h_tyler$miss_distance)

#For neo_nh_tyler as a whole:
sd(neo_nh_tyler$miss_distance)
```

```{r, results='markup'}
#Tyler 
#3. Graphical interpretations of the data:

#Histograms:
library(ggplot2)

#For neo_h_tyler as a whole:
ggplot(neo_h_tyler, aes(miss_distance, ..count../sum(..count..)*100))+
  geom_histogram(col = 'black', fill ='red', bins = 20)+
  labs(title = 'Histogram of relative frequency for `Miss Distance` of hazardous (n=8840)')+
  xlab('Miss distance (millions of kilometers)')+
  ylab('Frequency %')

#For neo_nh_tyler as a whole:
ggplot(neo_nh_tyler, aes(miss_distance, ..count../sum(..count..)*100))+
  geom_histogram(col = 'black', fill ='green', bins = 20)+
  labs(title = 'Histogram of relative frequency for `Miss Distance` of not hazardous (n=81996)')+
  xlab('Miss distance (millions of kilometers)')+
  ylab('Frequency %')

#Boxplot:
#For neo_h_tyler and neo_nh_tyler as a whole:
ggplot(neo_tyler, aes(y=neo_tyler$miss_distance, x=neo_tyler$hazardous))+
  geom_boxplot(colour = c('green', 'red'))+
  labs(title = 'Boxplot of `Miss distance` vs hazardous')+
  xlab('Hazardous')+
  ylab('Miss distance (millions of kilometers)')+
  scale_x_discrete(labels = c('Not hazardous','hazardous'))

#QQ-plots:
#For neo_h_tyler as a whole:
qqnorm(neo_h_tyler$miss_distance, col='red', main = 'QQ Plot for `miss_distance` of hazardous (n=8840)')
qqline(neo_h_tyler$miss_distance)
#For neo_nh_tyler as a whole:
qqnorm(neo_nh_tyler$miss_distance, col='green', main = 'QQ Plot for `miss_distance` of not hazardous (n=81996)')
qqline(neo_nh_tyler$miss_distance)
#Clearly under-dispersed data, or platykurtic distribution, having negative excess kurtosis. 
```

```{r, results='markup'}
#Tyler 
#5. [When Applicable] Normality tests

#shapiro.test(neo_h_tyler$miss_distance)
#shapiro.test(neo_nh_tyler$miss_distance)
```


```{r, results='markup'}
#Tyler 
#6. [When Applicable] Initial correlation - Chi-Squared tests - ANOVA analysis - T-test/Intervals
#For the entire group: Initial correlation 

#For the individual part: Chi-Squared tests - ANOVA analysis - T-test/Intervals
```

```{r, results='markup'}
#Tyler 
#6. [When Applicable] T-test/Intervals

#For neo_h_tyler as a whole at 95%:
t.test(neo_h_tyler$miss_distance)

#For neo_nh_tyler as a whole at 95%:
t.test(neo_nh_tyler$miss_distance)

#Do not overlap, lets try again at a much higher level of confidence

#For neo_h_tyler as a whole at 99%:
t.test(neo_h_tyler$miss_distance, conf.level = 0.99)

#For neo_nh_tyler as a whole at 99%:
t.test(neo_nh_tyler$miss_distance, conf.level = 0.99)

#Still do not overlap, which raises the question of whether these means are different 
#So, lets run ANOVA...
```


```{r, results='markup'}
#Tyler 
#6. [When Applicable] ANOVA

#H0: The mean for h and nh are the same 
#H1: The means are NOT the same

anova_tyler = aov(neo_tyler$miss_distance ~ neo_tyler$hazardous, neo_tyler)
summary(anova_tyler)

# Post-Hoc Follow-up
tukeyAoV <- TukeyHSD(anova_tyler)
tukeyAoV
```
